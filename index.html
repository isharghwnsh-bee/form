<html>


<div id="status"></div>
</div>


<script>
const { jsPDF } = window.jspdf;


// ðŸ” REPLACE with your deployed Google Apps Script Web App URL
const URL = "https://script.google.com/macros/s/AKfycbyhN0OLRdH6LKaj0HE-bZhRdVMHcXJ5H3P0ofm5pUbUg2Js7Z2yKkxSTkd3hZNrJ5w/exec";


const form = document.getElementById("studentForm");
const status = document.getElementById("status");
const btn = document.getElementById("btn");


form.addEventListener("submit", async (e) => {
e.preventDefault();


btn.disabled = true;
status.textContent = "Submitting...";


const formData = new FormData(form);


const fullName = formData.get("fullName");
const studentId = formData.get("studentId");
const email = formData.get("email");
const course = formData.get("course");
const notes = formData.get("notes");


try {
const res = await fetch(URL, { method: "POST", body: formData });
const data = await res.json();


if (data.status === "success") {
status.className = "success";
status.textContent = "âœ“ Saved! Downloading PDF...";


// ===== Generate PDF =====
const pdf = new jsPDF();
pdf.setFontSize(18);
pdf.text("Course Registration Details", 20, 20);


pdf.setFontSize(12);
let y = 40;


pdf.text(`Full Name : ${fullName}`, 20, y); y += 10;
pdf.text(`Student ID: ${studentId}`, 20, y); y += 10;
pdf.text(`Email : ${email}`, 20, y); y += 10;
pdf.text(`Course : ${course}`, 20, y); y += 15;


pdf.text("Notes:", 20, y);
y += 10;


const splitNotes = pdf.splitTextToSize(notes || "N/A", 170);
pdf.text(splitNotes, 20, y);


pdf.save(`${studentId}_registration.pdf`);


form.reset();
} else {
status.className = "error";
status.textContent = "âœ— " + data.message;
}
} catch (err) {
status.className = "error";
status.textContent = "âœ— Network error.";
console.error(err);
}


btn.disabled = false;
});
</script>
</body>
</html>